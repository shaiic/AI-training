# 微软-仪电人工智能高阶人才培训学习心得之四：301课程-《人工智能伦理与道德》《微软认知服务》

## 作者：朱晓潮（上海仪电人工智能创新院有限公司）

## 一、AI道德与伦理

​       今天的课程老师先给我们讲授AI道德和伦理课程，从什么是道德和伦理开始讲，讲到现代企业和技术人员为什么要讲道德和伦理，最后讲述AI道德和伦理目前碰到的问题。道德与伦理总的来说就是风俗、习惯的意思，是哲学的分支，可以建立人与人的关系，通过潜在的价值观对人产生制约。百度贴吧“魏则西”事件让人们意识到现代企业如果没有社会责任感，可能会出现严重的后果，会让技术作恶。技术本身不是“恶”，但是如果使用技术的人不讲道德伦理，会让技术产生“恶”的结果。所以对于一个企业来说“格局”的重要性，一个企业“格局有多大舞台就有多大”。 

​	   老师通过以下几个问题具体分析了AI伦理道德的内涵，讲解了世界各国对AI伦理进步所做的努力。

- **umemployment**
- **quality**
- **Humanity**
- **Racist robots**
- **Security**
- **Evil genies**
- **Singularity**
- **Robots rights**

​      其中印象比较深刻的是关于无人驾驶汽车的几个问题：

1. 无人汽车内坐着两个乘客，车外有两个行人，当车辆不得不发生碰撞事故时，优先保护谁？
2. 如果车外的人数远远大于2个人(例如10个人)时，那应该优先保护谁呢？
3.  无人驾驶汽车发生车祸后，到底是谁的责任？是设计系统的工程师还是车主？

​      对于以上问题其实是没有标准答案的，每个人都有自己不同的答案，或者在不同的时间点同一个人给出的答案也会前后不一样。这堂课重点不是教会我们什么是AI伦理道理，而是让学会多思考，在我们在心中埋下一颗作为技术人员“不为恶”的种子。



## 二、Azure 认知服务（Azure计算机视觉服务和LUIS）

### 1.Azure计算机视觉服务

​		计算机视觉API是Azure认知服务中一项比较常用和重要的服务，开发人员通过使用 计算机视觉API来处理图像并返回相关的信息。  通过上传图像或指定图像 URL，Azure计算机视觉算法基于输入和用户选择以不同方式分析图像，检测并提供有关视觉特性和特征的见解。计算机视觉API服务主要提供以下计算机视觉相关功能：

- **标记视觉特性**：根据可识别对象、生物、风景，操作识别并标记图像中的视觉特征。  。
- **检测对象**：对象检测识别图像中的对象，以及每个标记对象的边框坐标。 例如，如果图像包含狗、猫和人，检测操作将列出这些对象及其在图像中的坐标。
- **人脸检测**：	检测图像中的人脸，提供每个检测到的人脸的相关信息，返回每个检测到的人脸的坐标、性别和年龄等信息。
- **检测品牌**：根据一个包含数千全球商标的数据库，确定图像或视频中的商业品牌。
- **对图像分类**：使用具有父/子遗传层次结构的类别分类对整个图像进行标识和分类。 
- **描述图像**：计算机视觉算法可根据图像中标识的对象生成各种说明，以人类可读语言生成整个图像的说明，分别对这些说明进行评估并生成置信度分数。 
- **检测特定领域的内容**：使用领域模型来检测和标识图像中特定领域的内容，例如名人和地标。 例如，如果图像中包含人物，则使用针对名人的领域模型来确定图像中检测到的人物是否与已知名人匹配。
- **检测颜色方案**：分析图像中的颜色使用情况，可以确定图像是黑白的还是彩色的，而对于彩色图像，又可以确定主色和主题色。
- **生成缩略图：**分析图像的内容，生成该图像的相应缩略图。

​       老师在课堂上手把手带领我们编写“机器识熊”程序，带领我们进入到Azure计算机视觉API服务的世界。"机器识熊"程序的需求是通过Azure计算机视觉服务编写一个模型，让程序能够识别各种不同类型的熊。"机器识熊"程序的编写过程如下：

1. 新建计算机视觉API项目。登录https://www.customvision.ai网站，创建一个新的计算机视觉API项目，其中Project Types选择Classification，Classification Types选择Multiclass，Domains选择Genera

2. 创建标签。针对每一种我们想要识别的熊，创建一个标签。我们创建了black bear、brown bear和polar bear这三个标签分别代表黑熊、棕熊和北极熊。

3. 上传训练样本。我们先给这三类熊各找了10多张图片，在“Training Images”页面中通过上传这些图片来训练模型，上传图标的时候，需要我们对每一张图片选择对应的标签，如下图所示：

   ![1561606855653](C:\Users\zhuxc\AppData\Roaming\Typora\typora-user-images\1561606855653.png)

4. 训练模型。把各种标签对应的训练样本图片上传完成后，点击“Train”按钮，Training Types选择Fast Training进行模型训练。

5. 在线测试。模型训练完成后，就可以在线对训练好的模型进行测试了。点击“Quick Test”按钮，在弹出的页面中可以输入一张要检测的图片的URL或者本地图片后，就会给出检测结果，如下图所示：

   ![1561606973286](C:\Users\zhuxc\AppData\Roaming\Typora\typora-user-images\1561606973286.png)

6. 导出为ONNX。在Performance页面中，点击“Export”按钮，platform选择“ONNX”，version选择“ONNX1.2”后导出bear.onnx文件。

7. 创建C#项目。使用Microsoft Visual Studio创建一个新项目，把第6步导出的bear.onnx文件添加到该项目中。

8. 编写C#代码。构建一个窗体，包含一个文本输入框，用于输入要检测图片的URL；“识别”按钮用于触发调用Azure计算机视觉API；一个图片框用于显示URL对应的图片；一个标签框用于显示识别结果。

   Page_Loaded方法中加载bear.onnx 模型文件

   TbRecognize_Click方法用于点击“识别”按钮后从输入的URL获取要检测的图像，调用模型检测方法对该图片进行检测，把返回的检测结果显示在“识别结果”标签框中。

   

## 2.Azure语义识别服务（LUIS）

​       Azure语义识别服务LUIS (Language Understanding Intelligent Service，https://www.luis.ai) 是微软发布的面向开发者的自然语言语义理解服务。LUIS的使命是让非NLP专业的开发者能够轻松地创建和维护高质量的自然语言理解模型，并无缝对接到相关的智能应用当中。

​        通过LUIS平台，普通开发者可以轻松创建一个LUIS 应用，通过标注所期望的输入(自然语言指令)和输出(意图和实体)来进一步训练模型。在整个开发过程中，开发者并不需要了解背后算法的细节，只需要清晰地定义自己需要让机器理解的用户意图和实体即可。

​        LUIS的开发流程是一个训练的过程：开发者是老师，LUIS应用是学生。老师通过不停地告诉学生正确的语义解析结果来完成教学。一个好的教学过程是一个“训练+实践”的闭环：标注一定量的起始数据；训练得到语义理解模型；对模型进行必要的测试；发布模型并应用到真实用户场景；选择应用日志中的语句继续标注并更新模型。这个过程周而复始，通过不停地迭代开发，不停地改善理解模型，使其越来越接近人类的理解能力。

​       在这次课程中老师通过让我们动手实现一个“智能家居”模拟程序来了解和掌握LUIS应用程序开发的流程。“智能家居”模拟程序要实现的场景是通过人的语言指令来控制家里不同灯的开关。  “智能家居”模拟程序的开发流程如下：

1. 新建LUIS应用。登录https://www.luis.ai网站，创建一个新的LUIS应用，由于我们讲的是中文，因此区域选择Chinese。

2. 创建意向和实体。在本项目中我们创建了TurnOn和TurnOff这两个意向，分别代表开灯和关灯的意向。我们创建了台灯、床头灯、顶灯、卧室灯、客厅灯、全部灯这六个实体。在本项目的设计场景中卧室灯包括台灯和床头灯，客厅灯只包括顶灯，所有灯包括台灯、床头灯和顶灯。

3. 在线数据标注。首先，在对应的用户意图中输入自然语言示例指令，例如：在“TurnOn” 意向中输入一句“请关闭卧室里面的灯” ；然后，通过鼠标选取“卧室里面的灯”这几个字和“卧室灯”实体关联。本项目中“TurnOn” 意向我们标注了以下示例指令对应的实体：

   | 样例语句     | 词语   | 对应的实体 |
   | ------------ | ------ | ---------- |
   | 打开台灯     | 台灯   | 台灯       |
   | 打开床头灯   | 床头灯 | 床头灯     |
   | 打开顶灯     | 顶灯   | 顶灯       |
   | 打开客厅灯   | 客厅   | 客厅灯     |
   | 打开卧室灯   | 卧室   | 卧室灯     |
   | 把台灯打开   | 台灯   | 台灯       |
   | 把床头灯打开 | 床头灯 | 床头灯     |
   | 把顶灯打开   | 顶灯   | 顶灯       |
   | 把客厅灯打开 | 客厅灯 | 客厅灯     |
   | 把卧室灯打开 | 卧室灯 | 卧室灯     |
   | 客厅太暗了   | 客厅   | 客厅灯     |
   | 卧室太暗了   | 卧室   | 卧室灯     |
   | 打开所有灯   | 所有灯 | 全部灯     |
   | 打开全部灯   | 全部灯 | 全部灯     |

4. 训练模型。LUIS的模型训练过程极其简单，只需点击一下 “训练” 按钮，LUIS便会进行自动学习。训练的时间会因为标注数据量的不同而各异，标注数据越多，训练所需的时间越长。同时，训练时间还与LUIS应用所支持的意图和实体个数相关，意图和实体越多，训练时间也越长。

5. 在线测试。对于训练完成的模型，开发者可以对其进行测试。LUIS为开发者提供了交互式测试页面，只需输入测试用例，回车后系统自动会把识别结果返回，然后目测模型输出是否和预期一致。如下图所示,输入“打开客厅里的灯”回车后返回的最高得分意图是“TurnOn”，实体是“客厅灯”。开发者通过Http的get方法，就可以将开发的LUIS App接入到其他应用中。

   ![1561615023920](C:\Users\zhuxc\AppData\Roaming\Typora\typora-user-images\1561615023920.png)

6. 发布LUIS应用。点击“发布”按钮，弹出发布页面，环境选择“Production”，点击“发布”按钮完成发布。

   发布好以后在管理》应用程序设置》密钥和终结点页面中获取终结点，用于后续C#代码中。

   另外，可以点击分配资源来选择不同的LUIS资源。

   ![1561619921151](C:\Users\zhuxc\AppData\Roaming\Typora\typora-user-images\1561619921151.png)

7. 创建C#项目。使用Microsoft Visual Studio创建一个新项目。

8. 编写C#代码。构建一个窗体，包含一个"开始"按钮，用于启动程序；三个图片框，分别显示台灯、床头灯、顶灯的状态图片；一个标签框用于显示语音识别的情况以及LUIS识别的意向和实体情况。

   程序接受人的语音输入，调用Azure语音API服务把语音转换为文字，然后调用LUIS API，根据文字返回意向和实体。然后根据意向和实体来控制不同的灯的开关，其中开灯逻辑代码如下：

    private void OpenLight(string entity)
           {
               MakesureRunInUI(() =>
               {
                   if (!string.IsNullOrEmpty(entity) && entity == "床头灯")
                   {
                       pictureBox_CTD.Load("床头灯开.jpg");
                   }
                   else if (entity == "台灯")
                   {
                       pictureBox_TD.Load("台灯开.jpg");
                   }
                   else if (entity == "卧室灯")
                   {
                       pictureBox_CTD.Load("床头灯开.jpg");
                       pictureBox_TD.Load("台灯开.jpg");
                   }
                   else if (entity == "顶灯"|| entity == "客厅灯")
                   {
                       pictureBox_DD.Load("顶灯开.jpg");
                   }
                   else if (entity == "全部灯" || entity == "所有灯")
                   {
                       pictureBox_CTD.Load("床头灯开.jpg");
                       pictureBox_TD.Load("台灯开.jpg");
                       pictureBox_DD.Load("顶灯开.jpg");
                   }
               });
           }

   ​    

# 关于微软-仪电人工智能创新院

微软-仪电人工智能创新院将由微软和仪电共同运营和管理，致力于为微软和仪电在人工智能方面的联合研究活动和项目提供支持，为当地企业提供基于微软技术的人工智能研发平台服务和培训服务。

# 关于人工智能高阶人才培训班

微软和仪电共同打造的人工智能高阶人才培训班由创新院运营，第一期历时三个月，授课老师包括来自微软和仪电的多位专家，内容涵盖人工智能导论、数学基础、深度学习、应用实例等课程，以及关于强化学习、自然语言处理、计算机视觉等热门方向的专题研讨会，希望帮助学员掌握人工智能的理论与实践，培养具备前瞻视野和实践能力的创新型人才。

更多信息，请关注微信公众号 

![二维码](./image/barcode.jpg)

